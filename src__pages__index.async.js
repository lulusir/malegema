"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[858],{71549:function(nt,P,o){o.r(P),o.d(P,{default:function(){return et}});var A=o(30279),V=o.n(A),W=o(94434),H=o.n(W),$=o(9189),k=o.n($),E=o(58482),y=o.n(E),J=o(47722),G=o.n(J),Z=o(76779),b=o.n(Z),K=o(46332),N=o.n(K),Q=o(93275),l=o.n(Q),z=o(87182),f,c;(function(s){s[s.dong=0]="dong",s[s.xi=1]="xi",s[s.nan=2]="nan",s[s.bei=3]="bei",s[s.bai=4]="bai",s[s.fa=5]="fa",s[s.zhong=6]="zhong"})(c||(c={}));var U=(f={},l()(f,c.dong,"/malegema/assets/z1.gif"),l()(f,c.xi,"/malegema/assets/z2.gif"),l()(f,c.nan,"/malegema/assets/z3.gif"),l()(f,c.bei,"/malegema/assets/z4.gif"),l()(f,c.bai,"/malegema/assets/z5.gif"),l()(f,c.fa,"/malegema/assets/z6.gif"),l()(f,c.zhong,"/malegema/assets/z7.gif"),f),X=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return r*10},h=function(){function s(r){k()(this,s),l()(this,"id",s._id++),l()(this,"left",0),l()(this,"top",0),l()(this,"z",0),l()(this,"width",s.CardWidth),l()(this,"height",s.CardHeight),l()(this,"img",""),l()(this,"blocked",!1),l()(this,"deleted",!1),l()(this,"deleting",!1),this.type=r,this.img=U[this.type]}return y()(s,[{key:"setRect",value:function(i){var n,e,t,a;this.left=(n=i.left)!==null&&n!==void 0?n:this.left,this.top=(e=i.top)!==null&&e!==void 0?e:this.top,this.width=(t=i.width)!==null&&t!==void 0?t:this.width,this.height=(a=i.height)!==null&&a!==void 0?a:this.height}},{key:"intersect",value:function(i){var n=this;return Math.abs(n.left+n.width/2-i.left-i.width/2)<(n.width+i.width)/2&&Math.abs(n.top+n.height/2-i.top-i.height/2)<(n.height+i.height)/2}},{key:"delete",value:function(){var i=this;return this.deleting=!0,new Promise(function(n){setTimeout(function(){i.deleting=!1,i.deleted=!0,n(null)},300)})}}]),s}();l()(h,"CardWidth",20),l()(h,"CardHeight",28),l()(h,"_id",0);var B=function(){function s(){k()(this,s),l()(this,"left",0),l()(this,"top",0),l()(this,"z",0),l()(this,"data",[[]])}return y()(s,[{key:"init",value:function(i,n,e,t){this.left=n,this.top=e,this.z=t,this.data=i,this.setCardsPosition()}},{key:"setCardsPosition",value:function(){var i=this;this.data&&this.data.forEach(function(n,e){n.forEach(function(t,a){t&&(t.setRect({left:a*h.CardWidth+i.left,top:e*h.CardHeight+i.top}),t.z=i.z)})})}}]),s}(),I=function(){function s(){k()(this,s),l()(this,"left",180),l()(this,"top",700),l()(this,"data",[])}return y()(s,[{key:"init",value:function(){this.data=[]}},{key:"add",value:function(i){return this.data.length<7?(i.setRect({left:this.left+h.CardWidth*this.data.length,top:this.top}),this.data.push(i),!0):!1}},{key:"refresh",value:function(){var i=this;this.data.forEach(function(n,e){n.setRect({left:i.left+h.CardWidth*e,top:i.top})})}},{key:"remove",value:function(i){var n=0;this.data.forEach(function(a){a.type===i.type&&(n+=1)});var e=n===3;if(e){var t=Promise.all(this.data.filter(function(a){return a.type===i.type}).map(function(a){return a.delete()}));return this.data=this.data.filter(function(a){return a.type!==i.type}),this.refresh(),t}return Promise.resolve()}}]),s}(),R,D,F,m,x=[[1,1,1,1,1,1,0,1,1,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,1,1,1,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,1,1,0,1,0,0,1,1,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,0],[1,0,1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,1,0,1,0,1,1,1,1,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,1,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0],[1,1,1,1,0,0,1,1,1,1,1,1,1,0,0,0,0,1,0,1,0,0,0,0,0],[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0],[0,0,1,0,0,0,1,0,1,0,1,0,1,0,0,1,0,1,1,1,0,1,0,0,0],[0,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,0,0,1,0,0,0,1,0,0],[1,1,1,0,0,0,1,0,1,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,1,0,0,1,0,0,0,0,1,0,0,0,1,1,1,1,1,1,1,1,1,0,0],[1,0,1,0,0,1,0,0,1,0,1,0,1,0,0,0,1,0,1,0,1,0,0,0,0],[0,1,1,0,0,1,0,0,1,0,1,0,1,0,0,0,0,1,1,1,0,0,0,0,0],[0,0,1,0,1,0,0,0,1,1,1,1,1,0,0,1,1,1,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],Y=function(){return{data:[],slot:{top:0,left:0}}},T=(R=(0,z.b2)(),D=Reflect.metadata("design:type",Function),F=Reflect.metadata("design:paramtypes",[typeof I>"u"?Object:I,typeof B>"u"?Object:B]),R(m=D(m=F(m=function(s){b()(i,s);var r=N()(i);function i(n,e){var t;return k()(this,i),t=r.call(this),l()(G()(t),"allCard",[]),t.slot=n,t.layer=e,t.state=Y(),t}return y()(i,[{key:"setSlot",value:function(){var e=this;this.setState(function(t){t.slot.top=e.slot.top,t.slot.left=e.slot.left})}},{key:"initCards",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:x,t=3,a=0;e.forEach(function(S){S.forEach(function(j){j===1&&(a+=1)})});for(var v=a*t,d=[],p=0;p<v;p+=3)d.push(new h(p%7)),d.push(new h(p%7)),d.push(new h(p%7));var at=this.shuffle(d);function it(){var S=at.pop();return S}for(var C=0;C<t;C++)this.layer.init(e.map(function(S){return S.map(function(j){return j===1?it():0})}),C*4,C*6,X(C+1));this.allCard=d}},{key:"shuffle",value:function(e){for(var t=H()(e),a=t.length,v,d;a!==0;)d=Math.floor(Math.random()*a),a-=1,v=t[a],t[a]=t[d],t[d]=v;return t}},{key:"init",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:x,t=localStorage.getItem("blocks");t&&(e=JSON.parse(t)),this.slot.init(),this.setSlot(),this.initCards(e),this.updateBlock(),this.updateView()}},{key:"saveToLocal",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:x;localStorage.setItem("blocks",JSON.stringify(e))}},{key:"removeCache",value:function(){localStorage.removeItem("blocks")}},{key:"loadByLocal",value:function(){var e=localStorage.getItem("blocks");e&&this.init(JSON.parse(e))}},{key:"click",value:function(e){var t=this,a=this.allCard.find(function(d){return d.id===e});if(a&&!a.blocked){var v=this.slot.add(a);v?(this.slot.remove(a).then(function(){t.updateBlock(),t.updateView()}),this.updateBlock(),this.updateView()):alert("\u6E38\u620F\u7ED3\u675F\u54A7")}}},{key:"updateBlock",value:function(){var e=this;this.allCard.forEach(function(t){t.blocked=!1}),this.allCard.forEach(function(t){e.allCard.forEach(function(a){t!==a&&(t.deleted||a.deleted||t.intersect(a)&&(t.z>a.z?a.blocked=!0:t.blocked=!0))})})}},{key:"updateView",value:function(){var e=this;this.setState(function(t){t.data=e.allCard.map(function(a){return V()({},a)})})}}]),i}(z.qs))||m)||m)||m),L=o(54788),q=o(93236),st=o(41103),M,O,w,g,_=function(){return{blocks:Array(25).fill(Array(25).fill(!1))}},tt=(M=(0,z.b2)(),O=Reflect.metadata("design:type",Function),w=Reflect.metadata("design:paramtypes",[]),M(g=O(g=w(g=function(s){b()(i,s);var r=N()(i);function i(){var n;return k()(this,i),n=r.call(this),n.state=_(),n}return y()(i,[{key:"draw",value:function(e,t){this.setState(function(a){a.blocks[e][t]=!a.blocks[e][t]})}},{key:"getData",value:function(){return this.state.blocks.map(function(e){return e.map(function(t){return t?1:0})})}}]),i}(z.qs))||g)||g)||g),u=o(62086);function et(){var s=(0,L.i3)(T),r=s.p,i=s.s,n=(0,L.i3)(tt),e=n.p;return(0,q.useEffect)(function(){r.init()},[]),(0,u.jsxs)("div",{className:"page",children:[(0,u.jsxs)("div",{className:"editor",children:[(0,u.jsx)("b",{children:"\u5730\u56FE\u7F16\u8F91\u533A"}),e.state.blocks.map(function(t,a){return(0,u.jsx)("div",{className:"editor-row",children:t.map(function(v,d){return(0,u.jsx)("div",{onClick:function(){e.draw(a,d)},className:"editor-block ".concat(v?"selected":"")})})})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("button",{onClick:function(){var a=e.getData();r.saveToLocal(a),r.init(a)},children:"\u4FDD\u5B58"}),(0,u.jsx)("button",{onClick:function(){var a=e.getData();r.removeCache(),r.init()},children:"\u6E05\u9664\u7F13\u5B58"})]})]}),(0,u.jsxs)("div",{className:"playground",children:[i.data.map(function(t){return!t||t.deleted?null:(0,u.jsx)("img",{onClick:function(){r.click(t.id)},className:"card ".concat(t.blocked?"isBlocked":""," ").concat(t.deleting?"animate__animated animate__fadeOut":""),src:t.img,style:{left:t.left,top:t.top,zIndex:t.z,width:t.width+"px",height:t.height+"px"}},t.id)}),(0,u.jsx)("div",{className:"slot",style:{left:r.state.slot.left,top:r.state.slot.top}})]}),(0,u.jsx)("div",{className:"actions",style:{},children:(0,u.jsx)("button",{type:"button",className:"btn1",onClick:function(){r.init()},children:"\u91CD\u6765\u4E00\u5C40"})})]})}}}]);
